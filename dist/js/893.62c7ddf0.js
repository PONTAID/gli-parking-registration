"use strict";(self["webpackChunkparking_registration"]=self["webpackChunkparking_registration"]||[]).push([[893],{3980:function(t,e,a){a.r(e),a.d(e,{default:function(){return y}});var o=a(6190),i=a(4145),l=a(4886),n=a(266),s=a(1030),r=a(4061),d=a(9223),c=a(4324),g=a(9592),u=a(1713),m=a(3687),h=a(7808),p=function(){var t=this,e=t._self._c;return e(n.Z,{staticClass:"d-flex justify-center"},[e(r.Z,{attrs:{persistent:"",width:"300"},model:{value:t.dialog.loading,callback:function(e){t.$set(t.dialog,"loading",e)},expression:"dialog.loading"}},[e(i.Z,{attrs:{color:"primary",dark:""}},[e(l.ZB,[t._v(" Please stand by "),e(g.Z,{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),e("div",{staticStyle:{display:"flex","align-items":"start","justify-content":"center"}},[e(i.Z,{staticClass:"mb-4 px-8 py-4 mt-12 text-center",staticStyle:{"border-radius":"25px 25px 25px 25px !important"},attrs:{flat:"",tile:"",width:"800"}},[e("div",{staticClass:"my-4 pa-4 px-6 d-flex flex-row",staticStyle:{width:"100% !important"}},[e(i.Z,{staticStyle:{width:"100% !important"},attrs:{elevation:"3",outlined:""}},[e(u.Z,[e(n.Z,[e("div",{staticClass:"ma-4 pa-2 d-flex flex-row"},[e("h1",{staticStyle:{"font-weight":"400"}},[t._v("Posting")])])])],1),e(d.Z,{staticClass:"ml-8 mr-8"}),e("div",{staticStyle:{width:"100%"}},[e(n.Z,{attrs:{cols:"12",md:"12"}},[e(i.Z,{staticClass:"ma-0 pa-0",attrs:{flat:"",width:"100%"}},[e(l.ZB,{attrs:{width:"100%"}},[e(r.Z,{ref:"dialog",staticClass:"ma-0 pa-0",attrs:{"return-value":t.date,persistent:"",width:"290px"},on:{"update:returnValue":function(e){t.date=e},"update:return-value":function(e){t.date=e}},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:o}){return[e(u.Z,{staticClass:"ma-0 pa-0 mt-5 mb-7"},[e("h2",{staticClass:"black--text"},[t._v("Pilih tanggal data yang ingin di posting ke dalam report:")])]),e(h.Z,t._g(t._b({attrs:{label:"Pilih Tanggal",value:t.getDateString(),"prepend-inner-icon":"mdi-calendar","hide-details":"",outlined:"",readonly:""}},"v-text-field",o,!1),a))]}}]),model:{value:t.dialog.date,callback:function(e){t.$set(t.dialog,"date",e)},expression:"dialog.date"}},[e(u.Z,{staticClass:"ma-0 pa-0",attrs:{justify:"center"}},[e(s.Z,{attrs:{locale:"id",width:"290px",max:t.dateMax,height:"300px",type:"month"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}},[e(o.Z,{attrs:{text:"",color:"primary"},on:{click:function(e){t.dialog.date=!1}}},[t._v("Cancel")]),e(o.Z,{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.dialog.save(t.date)}}},[t._v("OK")])],1)],1)],1),e(u.Z,{staticClass:"ma-0 pa-0 mt-10"},[e(m.Z),e(o.Z,{staticClass:"mb-5",staticStyle:{"text-transform":"unset",color:"black","font-size":"small"},attrs:{width:"150",color:"blue lighten-1"},on:{click:t.posting}},[e(c.Z,{staticClass:"mr-2",attrs:{small:""}},[t._v("mdi-typewriter")]),t._v("Â Posting ")],1)],1)],1)],1)],1)],1)],1)],1)])],1)],1)},v=[],k=(a(7658),a(594)),S=a(6955),f={name:"Posting",components:{},data(){return{date:new Date((new Date).setMonth((new Date).getMonth()-1)).toISOString().substr(0,10),dateMax:new Date((new Date).setMonth((new Date).getMonth()-1)).toISOString().substr(0,10),dialog:{date:!1,loading:!1}}},methods:{getDateString(){const t=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];return console.log(this.date+" "+this.dateMax),t[new Date(this.date).getMonth()]+" "+String(new Date(this.date).getFullYear())},route(t){this.$router.push({name:t}).catch((t=>{console.log(t)}))},removeLocalStorage(){localStorage.removeItem("nama"),localStorage.removeItem("phone"),localStorage.removeItem("email"),localStorage.removeItem("manager"),localStorage.removeItem("cost_center"),localStorage.removeItem("token"),localStorage.removeItem("selection"),localStorage.removeItem("nik"),this.route("login")},async posting(){try{this.dialog.loading=!0;const t={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, OPTIONS, post, get","Access-Control-Allow-Headers":"Origin, Content-Type, X-Auth-Token","Content-Type":"application/json","Content-Length":"<calculated when request is sent>",Host:"<calculated when request is sent>",Accept:"*/*","Accept-Encoding":"gzip, deflate, br",Connection:"keep-alive",app:"sso"};if(await k.Z.get(S.Y+"posting?mu_token="+localStorage.getItem("token")+"&mu_username="+localStorage.getItem("nik")+"&month="+this.date,t).then((t=>{if(this.data=t.data.data,console.log(t),"22"==t.data.response_code)localStorage.removeItem("nik"),alert("Token sudah kadaluarsa. Silahkan Login kembali!"),this.removeLocalStorage();else if("21"==t.data.response_code)alert("NIK tidak ditemukan. Silahkan Login kembali!"),this.removeLocalStorage();else if("20"==t.data.response_code)alert("Token tidak sesuai. Silahkan Login kembali!"),this.removeLocalStorage();else{if("12"==t.data.response_code)return alert("Data bulan "+this.getDateString()+" sudah pernah di posting!"),void(this.dialog.loading=!1);if(0==t.data.status)return alert("Data bulan "+this.getDateString()+" masih kosong!"),void(this.dialog.loading=!1);if(this.data==[])return;if(!this.data)return void alert("Gagal Posting Data!")}})).catch((t=>{console.log("ParkingRegistration.vue (error) :: ",t),alert("Gagal posting data kendaraan! Silahkan coba lagi."),this.dialog.loading=!1})),!this.data)return void(this.dialog.loading=!1)}catch(t){return console.error(t),alert("Error: koneksi gagal"),void(this.dialog.loading=!1)}alert("Posting data bulan "+this.getDateString()+" berhasil!"),this.dialog.loading=!1}},async mounted(){localStorage.nama||this.removeLocalStorage(),"HRGA"!=localStorage.getItem("cost_center")&&this.route("home")}},b=f,w=a(1001),x=(0,w.Z)(b,p,v,!1,null,null,null),y=x.exports}}]);