"use strict";(self["webpackChunkparking_registration"]=self["webpackChunkparking_registration"]||[]).push([[951],{3682:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var l=a(6190),i=a(4145),n=a(4886),r=a(266),o=a(1030),s=a(4061),c=a(9223),d=a(4324),g=a(9592),p=a(1713),m=a(9481),u=a(3687),k=a(7808),h=function(){var e=this,t=e._self._c;return t(r.Z,{staticClass:"d-flex justify-center"},[t(s.Z,{attrs:{persistent:"",width:"300"},model:{value:e.dialog.loading,callback:function(t){e.$set(e.dialog,"loading",t)},expression:"dialog.loading"}},[t(i.Z,{attrs:{color:"primary",dark:""}},[t(n.ZB,[e._v(" Please stand by "),t(g.Z,{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),t(s.Z,{attrs:{persistent:"",width:"500"},model:{value:e.dialog.fail,callback:function(t){e.$set(e.dialog,"fail",t)},expression:"dialog.fail"}},[t(i.Z,{staticClass:"text-center"},[t(d.Z,{staticClass:"mt-5 mb-3",attrs:{size:"100",color:"error"}},[e._v("mdi-close-circle-outline")]),t(n.ZB,{staticStyle:{"font-size":"16px"}},[e._v("Data kendaraan tidak ada")]),t(l.Z,{staticClass:"mb-10",attrs:{color:"primary",width:"100"},on:{click:e.close}},[e._v(" OK ")])],1)],1),t(s.Z,{ref:"dialog",staticClass:"ma-0 pa-0",attrs:{"return-value":e.date,persistent:"",width:"290px"},on:{"update:returnValue":function(t){e.date=t},"update:return-value":function(t){e.date=t}},model:{value:e.dialog.date,callback:function(t){e.$set(e.dialog,"date",t)},expression:"dialog.date"}},[t(p.Z,{staticClass:"ma-0 pa-0",attrs:{justify:"center"}},[t(o.Z,{attrs:{locale:"id",width:"290px",height:"300px",type:"month"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}},[t(l.Z,{attrs:{text:"",color:"primary"},on:{click:function(t){e.dialog.date=!1}}},[e._v("Cancel")]),t(l.Z,{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.dialog.save(e.date)}}},[e._v("OK")])],1)],1)],1),t("div",{staticStyle:{display:"flex","align-items":"start","justify-content":"center"}},[t(i.Z,{staticClass:"mb-4 px-8 py-4 mt-15 text-center",staticStyle:{"border-radius":"25px 25px 25px 25px !important"},attrs:{flat:"",tile:"",width:"800"}},[t("div",{staticClass:"my-4 pa-4 px-6 d-flex flex-row",staticStyle:{width:"100% !important"}},[t(i.Z,{staticStyle:{width:"100% !important"},attrs:{elevation:"3",outlined:""}},[t(p.Z,[t(r.Z,[t("div",{staticClass:"ma-4 pa-2 d-flex flex-row"},[t("h1",{staticStyle:{"font-weight":"400"}},[e._v("Report "+e._s("finance"==e.mode?"Finance":"quality-parking"==e.mode?"Quality Parking":"Transportasi Online"))])])])],1),t(c.Z,{staticClass:"ml-8 mr-8"}),t("div",{staticStyle:{width:"100%"}},[t(r.Z,{attrs:{cols:"12",md:"12"}},[t(i.Z,{staticClass:"ma-0 pa-0",attrs:{flat:"",width:"100%"}},[t(n.ZB,{attrs:{width:"100%"}},[t(p.Z,{staticClass:"ma-0 pa-0 mt-5 mb-7"},[t("h2",{staticClass:"black--text"},[e._v("Pilih data report "+e._s("finance"==e.mode?"finance":"quality-parking"==e.mode?"Quality Parking":"Transportasi Online")+" yang ingin di download:")])]),"finance"==e.mode||"report-gocorp"==e.mode?t(p.Z,{staticClass:"ma-0 pa-0"},[t(k.Z,{attrs:{label:"Pilih Tanggal",value:e.getDateString(),"prepend-inner-icon":"mdi-calendar","hide-details":"",outlined:"",readonly:""},on:{click:function(t){e.dialog.date=!0}}})],1):"quality-parking"==e.mode?t(p.Z,{staticClass:"ma-0 pa-0"},[t(r.Z,{staticClass:"ma-0 pa-0",attrs:{cols:"12",md:"12"}},[t(p.Z,{staticClass:"ma-0 pa-0"},[t(r.Z,{staticClass:"pa-0",attrs:{cols:"4"}},[t(k.Z,{attrs:{label:"Pilih Tanggal",value:e.getDateString(),"prepend-inner-icon":"mdi-calendar","hide-details":"",outlined:"",readonly:""},on:{click:function(t){e.dialog.date=!0}}})],1),t(r.Z,{staticClass:"pa-0 pr-1 pl-1",attrs:{cols:"4"}},[t(m.Z,{attrs:{label:"Tipe Kepemilikan",items:e.kepemilikan_select,required:"",outlined:""},on:{change:e.changeType},model:{value:e.kepemilikan,callback:function(t){e.kepemilikan=t},expression:"kepemilikan"}})],1),t(r.Z,{staticClass:"pa-0",attrs:{cols:"4"}},[t(m.Z,{attrs:{label:"Tipe Kendaraan",items:e.type_select,readonly:"COMPANY"==e.kepemilikan,filled:"COMPANY"==e.kepemilikan,required:"",outlined:""},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1)],1)],1)],1):e._e(),t(p.Z,{staticClass:"ma-0 pa-0 mt-10"},[t(u.Z),t(l.Z,{staticClass:"mb-5",staticStyle:{"text-transform":"unset",color:"black","font-size":"small"},attrs:{width:"150",color:"green darken-1 white--text"},on:{click:e.downloadReport}},[t(d.Z,{staticClass:"mr-2",attrs:{small:"",dark:""}},[e._v("mdi-download")]),e._v("Â Download ")],1)],1)],1)],1)],1)],1)],1)],1)])],1)],1)},y=[],v=(a(7658),a(594)),f=a(6955),b={name:"Report",components:{},data(){return{counter:0,kepemilikan_select:["PRIBADI","COMPANY"],type_select:["SEMUA","MOBIL","MOTOR"],date:String((new Date).getFullYear()+"-"+("0"+((new Date).getMonth()+1)).slice(-2)),kepemilikan:null,type:"SEMUA",search:"",mode:null,dialog:{date:!1,loading:!1,fail:!1}}},methods:{route(e){this.$router.push({name:e}).catch((e=>{console.log(e)}))},changeType(){"COMPANY"==this.kepemilikan?(this.type="SEMUA",this.type_select=["SEMUA","MOBIL","MOTOR"]):"PRIBADI"==this.kepemilikan&&(this.type="MOBIL",this.type_select=["MOBIL","MOTOR"])},removeLocalStorage(){localStorage.removeItem("nama"),localStorage.removeItem("phone"),localStorage.removeItem("email"),localStorage.removeItem("manager"),localStorage.removeItem("cost_center"),localStorage.removeItem("token"),localStorage.removeItem("selection"),localStorage.removeItem("nik"),this.route("login")},async downloadReport(){var e="";if("finance"==this.mode)e=f.Y+"get-report-finance";else{if("quality-parking"==this.mode){if(null==this.kepemilikan)return void alert("Wajib mengisi kolom tipe kepemilikan!");var t="PRIBADI"==this.kepemilikan?"P":"C";e="https://app.gli.id/transport/#/qp-download?flag="+t+"&period="+this.date,"MOBIL"!=this.type&&"MOTOR"!=this.type||(e=e+"&type="+String(this.type).toLowerCase());var a=document.createElement("a");return a.href=e,a.target="_blank",document.body.appendChild(a),a.click(),void document.body.removeChild(a)}"report-gocorp"==this.mode&&(e=f.T+"get-report")}try{this.dialog.loading=!0;const t={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, OPTIONS, post, get","Access-Control-Allow-Headers":"Origin, Content-Type, X-Auth-Token","Content-Type":"application/json","Content-Length":"<calculated when request is sent>",Host:"<calculated when request is sent>",Accept:"*/*","Accept-Encoding":"gzip, deflate, br",Connection:"keep-alive",app:"sso"};if(await v.Z.get(e+"?mu_username="+localStorage.getItem("nik")+"&mu_token="+localStorage.getItem("token")+"&period="+String(this.date),t).then((t=>{if("22"==t.data.response_code)alert("Token sudah kadaluarsa. Silahkan Login kembali!"),this.removeLocalStorage();else if("21"==t.data.response_code)alert("NIK tidak ditemukan. Silahkan Login kembali!"),this.removeLocalStorage();else if("20"==t.data.response_code)alert("Token tidak sesuai. Silahkan Login kembali!"),this.removeLocalStorage();else{if("31"==t.data.response_code)return void(this.dialog.fail=!0);if("OK"!=t.statusText)return alert("Gagal mendownload file excel. Silahkan coba lagi!"),void(this.dialog.loading=!1);var a=document.createElement("a");a.href=e+"?mu_token="+localStorage.getItem("token")+"&mu_username="+localStorage.getItem("nik")+"&period="+String(this.date),a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)}})).catch((e=>{console.log("ParkingRegistration.vue (error) :: ",e),this.dialog.fail=!0})),!this.data)return void(this.dialog.loading=!1)}catch(l){return console.error(l),void alert("Error: koneksi gagal")}this.dialog.loading=!1},getDateString(){const e=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];return e[new Date(this.date).getMonth()]+" "+String(new Date(this.date).getFullYear())},close(){this.dialog.fail=!1,window.close()},formatCurrency(e){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e).split(",00").join("").replaceAll(".",",")},getHeader(){return"finance"==this.mode?[{text:"No",align:"center",value:"id",class:"black--text grey lighten-2"},{text:"NIK",align:"center",value:"prkr_nik",class:"black--text grey lighten-2"},{text:"Nama Karyawan",align:"center",value:"prkr_nama",class:"black--text grey lighten-2"},{text:"Jenis Kendaraan",align:"center",value:"prkr_type",class:"black--text grey lighten-2"},{text:"Keterangan Kendaraan",align:"center",value:"prkr_kepemilikan",class:"black--text grey lighten-2"},{text:"No. Polisi",align:"center",value:"prkr_nopol",class:"black--text grey lighten-2"},{text:"Tanggungan Perusahaan",align:"center",sortable:!1,value:"prkr_biaya_subsidi",class:"black--text grey lighten-2"},{text:"Tanggungan Karyawan",align:"center",value:"tanggungan_karyawan",class:"black--text grey lighten-2"}]:"quality-parking"==this.mode?[{text:"No",align:"center",value:"id",class:"black--text grey lighten-2"},{text:"Nama Karyawan",align:"center",value:"prkr_nama",class:"black--text grey lighten-2"},{text:"No. Polisi",align:"center",value:"prkr_nopol",class:"black--text grey lighten-2"},{text:"Jenis Kendaraan",align:"center",value:"prkr_type",class:"black--text grey lighten-2"},{text:"Biaya Berlangganan",align:"center",value:"prkr_total_biaya_perbulan",class:"black--text grey lighten-2"},{text:"Biaya Kartu",align:"center",sortable:!1,value:"prkr_biaya_kartu",class:"black--text grey lighten-2"}]:void 0}},async mounted(){localStorage.nama||this.removeLocalStorage(),this.mode=this.$route.meta.mode,"HRGA"!=localStorage.getItem("cost_center")&&"report-gocorp"!=this.mode?this.route("home"):("Y"==localStorage.getItem("manager")||"HRGA"!=localStorage.getItem("cost_center")&&"report-gocorp"==this.mode)&&this.route("home-gocorp"),null==this.mode&&this.route("home")}},x=b,_=a(1001),S=(0,_.Z)(x,h,y,!1,null,null,null),C=S.exports}}]);